(this["webpackJsonpblog-frontend"]=this["webpackJsonpblog-frontend"]||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n(0),i=n.n(s),a=n(11),r=n.n(a),o=(n(18),n(2)),l=n(3),u=(n(19),function(){var e=Object(s.useState)(null),t=Object(l.a)(e,2),n=t[0],i=t[1],a=Object(s.useState)(""),r=Object(l.a)(a,2),u=r[0],d=r[1];return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Blogger Home"}),Object(c.jsx)("div",{className:"app",children:n?Object(c.jsx)(v,Object(o.a)(Object(o.a)({},{token:n}),{username:u})):Object(c.jsx)(f,Object(o.a)(Object(o.a)({},{setToken:i}),{setUsername:d}))})]})}),d=n(6),j=n(8),b=n(5),O=(n(20),function(e){var t=e.button,n=e.filters,i=e.setFilters,a=e.resetFilters,r=b.b.apply(void 0,Object(j.a)(t.states)),u=Object(l.a)(r,2),O=u[0],h=u[1],m=Object(s.useState)(!1),f=Object(l.a)(m,2),v=f[0],p=f[1];return Object(s.useEffect)((function(){"View All"===O&&a()}),[O,a]),Object(c.jsxs)(b.a.div,{layout:!0,className:"switch ".concat(v?"on":"off"),onClick:function(){p(!v),h(),i((function(e){return Object(o.a)(Object(o.a)({},e),{},Object(d.a)({},t.filter,!n[t.filter]))}))},children:[Object(c.jsx)(b.a.button,{layout:!0,transition:{ease:"easeOut"}}),Object(c.jsx)(b.a.div,{layout:!0,transition:{ease:"easeOut"},className:"toggle-text",children:O})]})}),h=(n(21),[{states:["View All","Hide"],filter:"viewAll"},{states:["Yours","Others"],filter:"usersPosts"},{states:["Unublished","Published"],filter:"published"},{states:["Newest","Oldest"],filter:"dateAdded"}]),m=function(e){var t=e.posts,n=e.setFilteredPosts,i=e.username,a=Object(s.useMemo)((function(){return{viewAll:!0,usersPosts:null,published:null}}),[]),r=Object(s.useState)(a),u=Object(l.a)(r,2),d=u[0],b=u[1],m=Object(s.useCallback)((function(){return b(a)}),[a]);return Object(s.useEffect)((function(){var e=Object(j.a)(t);d&&!1!==d.viewAll?(!0===d.usersPosts?e=e.filter((function(e){return e.author===i})):!1===d.userPosts&&(e=e.filter((function(e){return e.author!==i}))),!0===d.published?e=e.filter((function(e){return e.published})):!1===d.published&&(e=e.filter((function(e){return!e.published}))),!0===d.dateAdded?e=e.sort((function(e,t){return e.timeCreated>t.timeCreated?1:-1})):!1===d.dateAdded&&(e=e.sort((function(e,t){return e.timeCreated<t.timeCreated?1:-1})))):e=[],n(e)}),[b,t,i,d,n]),Object(c.jsx)("div",{className:"filter-bar",children:h.map((function(e,t){return Object(s.createElement)(O,Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},{button:e}),{resetFilters:m}),{setFilters:b}),{filters:d}),{},{key:t}))}))})},f=(n(22),function(e){var t=e.setToken,n=e.setUsername,i=Object(s.useState)(""),a=Object(l.a)(i,2),r=a[0],o=a[1],u=Object(s.useState)(""),d=Object(l.a)(u,2),j=d[0],b=d[1],O=Object(s.useState)(null),h=Object(l.a)(O,2),m=h[0],f=h[1];return Object(c.jsxs)("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),console.log("checking post to ".concat("still-eyrie-61337.herokuapp.com")),fetch("still-eyrie-61337.herokuapp.com/users/login",{method:"POST",body:JSON.stringify({email:r,password:j}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.token&&(t(e.token),n(e.username)),e.message&&f(e.message.message)}))},children:[Object(c.jsx)("h2",{className:"form-title",children:"Login"}),m&&Object(c.jsxs)("div",{className:"error",children:["- ",m]}),Object(c.jsxs)("label",{children:["Email:",Object(c.jsx)("input",{type:"email",name:"email",value:r,onChange:function(e){return o(e.target.value)}})]}),Object(c.jsxs)("label",{children:["Password:",Object(c.jsx)("input",{type:"password",name:"password",value:j,onChange:function(e){return b(e.target.value)}})]}),Object(c.jsx)("button",{type:"submit",children:"Submit"})]})}),v=(n(23),function(e){var t=e.token,n=e.username,i=Object(s.useState)([]),a=Object(l.a)(i,2),r=a[0],u=a[1],d=Object(s.useState)(r),j=Object(l.a)(d,2),b=j[0],O=j[1],h=Object(s.useState)(!1),f=Object(l.a)(h,2),v=f[0],p=f[1],N=Object(s.useState)([]),g=Object(l.a)(N,2),y=g[0],C=g[1],S=Object(s.useState)(null),P=Object(l.a)(S,2),E=P[0],w=P[1],A=Object(s.useState)(!1),F=Object(l.a)(A,2),L=F[0],T=F[1],_={Authorization:"Bearer ".concat(t),"content-type":"application/json"},B=function(e){w(null===e||void 0===e?void 0:e.message),C((null===e||void 0===e?void 0:e.errors)?e.errors.map((function(e){return e.msg})):(null===e||void 0===e?void 0:e.err)?[e.err]:[]),H()},D=function(e,t){var n=JSON.stringify(Object(o.a)(Object(o.a)({},e),t));fetch("".concat("still-eyrie-61337.herokuapp.com","/posts/").concat(e._id),{method:"PUT",body:n,headers:_}).then((function(e){return e.json()})).then((function(e){return B(e)}))},J=function(e){fetch("".concat("still-eyrie-61337.herokuapp.com","/posts/").concat(e._id),{method:"DELETE",headers:_}).then((function(e){return e.json()})).then((function(e){return B(e)}))},U=function(e,t){fetch("".concat("still-eyrie-61337.herokuapp.com","/posts/").concat(t._id,"/").concat(e),{method:"DELETE",headers:_}).then((function(e){return e.json()})).then((function(e){return B(e)}))},H=function(){fetch("".concat("still-eyrie-61337.herokuapp.com","/posts")).then((function(e){return e.json()})).then((function(e){u(e.posts.sort((function(e,t){return e.timeCreated>t.timeCreated?-1:1}))),p(!0)}),(function(e){C([e]),p(!0)}))};return Object(s.useEffect)((function(){H()}),[]),v?Object(c.jsxs)("div",{className:"container",children:[Object(c.jsxs)("div",{className:"message-container",children:[(null===y||void 0===y?void 0:y.length)>0&&Object(c.jsxs)("div",{className:"errors",children:[Object(c.jsx)("h4",{className:"err-title",children:"Errors: "}),y.map((function(e,t){return Object(c.jsxs)("div",{children:["- ",e]},t)})),Object(c.jsx)("div",{className:"ok-btn",children:Object(c.jsx)("button",{onClick:function(){return C([])},children:"OK"})})]}),(null===E||void 0===E?void 0:E.length)>0&&Object(c.jsxs)("div",{className:"message",children:[E,Object(c.jsx)("div",{className:"ok-btn",children:Object(c.jsx)("button",{onClick:function(){return w(null)},children:"OK"})})]})]}),Object(c.jsxs)("div",{className:"head-bar",children:[Object(c.jsx)("button",{className:"new-btn",onClick:function(){return T(!0)},children:"New Post"}),Object(c.jsx)(m,Object(o.a)(Object(o.a)(Object(o.a)({},{setFilteredPosts:O}),{posts:r}),{username:n}))]}),Object(c.jsx)("div",{className:"posts-container",children:b.map((function(e){return Object(s.createElement)(x,Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},{post:e}),{headers:_}),{updatePost:D}),{getPosts:H}),{deletePost:J}),{deleteComment:U}),{},{key:e._id}))}))}),L&&Object(c.jsx)(k,Object(o.a)({exitForm:function(){return T(!1)},action:function(e){fetch("".concat("still-eyrie-61337.herokuapp.com","/posts/"),{method:"POST",body:JSON.stringify(e),headers:_}).then((function(e){return e.json()})).then((function(e){return B(e)}))}},{headers:_}))]}):Object(c.jsx)("div",{className:"loading",children:"Loading..."})}),p=function(e){var t=e.comments,n=e.exit,s=e.deleteComment;return Object(c.jsxs)("div",{className:"comment-box",children:[Object(c.jsx)("div",{className:"exit-btn",onClick:function(){return n()},children:"x"}),t.map((function(e,t){var n=e.content,i=e.timeCreated,a=e.author.username,r=e.post,o=e._id;return Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsx)("button",{className:"delete-btn",onClick:function(){return s(o,r)},children:"DEL"}),Object(c.jsx)("div",{className:"comment-content",children:n}),Object(c.jsxs)("div",{className:"secondary-bar footer",children:[Object(c.jsxs)("div",{className:"author",children:["By: ",a]}),Object(c.jsxs)("div",{className:"dates",children:["Posted ",i]})]})]},t)}))]})},x=(n(24),function(e){var t,n,i=e.post,a=e.post,r=a.title,u=a.content,d=a.author,j=a.comments,b=a.published,O=e.updatePost,h=e.deletePost,m=e.deleteComment,f=Object(s.useState)(!1),v=Object(l.a)(f,2),x=v[0],N=v[1],g=Object(s.useState)(!1),y=Object(l.a)(g,2),C=y[0],S=y[1];return Object(c.jsxs)("div",{className:"post-tile",children:[Object(c.jsx)("h2",{className:"title",onClick:function(){return N(!0)},children:r}),Object(c.jsxs)("h3",{className:"author",children:["By ",d.username]}),Object(c.jsxs)("p",{className:"content-short",children:[u.slice(0,50),"..."]}),Object(c.jsxs)("div",{className:"secondary-bar",children:[Object(c.jsx)("div",{className:"published",children:b?"Published":"Unpublished"}),Object(c.jsxs)("div",{className:"comments",onClick:function(){return S(!0)},children:["Comments (",(null===j||void 0===j?void 0:j.length)||0,")"]})]}),Object(c.jsxs)("div",{className:"dates secondary-bar",children:[Object(c.jsxs)("div",{children:["Added: ",null===(t=i.timeCreated)||void 0===t?void 0:t.slice(0,10)]}),Object(c.jsxs)("div",{children:["Last Edited: ",null===(n=i.timeLastEdited)||void 0===n?void 0:n.slice(0,10)]})]}),C&&Object(c.jsx)(p,Object(o.a)(Object(o.a)({},{comments:j}),{},{exit:S.bind(!1)},{deleteComment:m})),x&&Object(c.jsx)(k,Object(o.a)(Object(o.a)({post:i,exitForm:N.bind(!1)},{deletePost:h}),{},{action:function(e){return O(i,e)}}))]})}),N=n(10),g=n.n(N),y=n(12),k=(n(26),function(e){var t,n,i,a=e.post,r=void 0===a?null:a,u=e.exitForm,d=e.action,j=e.deletePost,b=Object(s.useState)({title:(null===r||void 0===r?void 0:r.title)||"",content:(null===r||void 0===r?void 0:r.content)||"",published:(null===r||void 0===r?void 0:r.published)||!1}),O=Object(l.a)(b,2),h=O[0],m=O[1],f=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(h);case 2:u();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)("form",{className:"post-form",onSubmit:f,children:[Object(c.jsx)("button",{type:"button",className:"exit-btn",onClick:function(){return u()},children:"x"}),Object(c.jsxs)("label",{children:["Title",Object(c.jsx)("input",{type:"text",name:"title",value:h.title,onChange:function(e){return m(Object(o.a)(Object(o.a)({},h),{},{title:e.target.value}))}})]}),Object(c.jsxs)("label",{children:["Content",Object(c.jsx)("textarea",{rows:5,name:"content",value:h.content,onChange:function(e){return m(Object(o.a)(Object(o.a)({},h),{},{content:e.target.value}))}})]}),Object(c.jsxs)("label",{className:"published",children:["Published",Object(c.jsx)("input",{type:"checkbox",name:"published",checked:h.published,onChange:function(e){return m(Object(o.a)(Object(o.a)({},h),{},{published:e.target.checked}))}})]}),Object(c.jsxs)("div",{className:"buttons-footer",children:[Object(c.jsx)("button",{type:"submit",className:"save",children:"Save"}),(null===r||void 0===r?void 0:r._id)&&Object(c.jsx)("button",{type:"button",className:"delete",onClick:function(){return j(r)},children:"Delete"})]}),(null===r||void 0===r?void 0:r._id)&&Object(c.jsxs)("div",{className:"update-post-footer",children:[Object(c.jsxs)("div",{children:["Comments: (",null===(t=r.comment)||void 0===t?void 0:t.count,")"]}),Object(c.jsxs)("div",{className:"dates secondary-bar",children:[Object(c.jsxs)("div",{children:["Added: ",null===(n=r.timeCreated)||void 0===n?void 0:n.slice(0,10)]}),Object(c.jsxs)("div",{children:["Last Edited: ",null===(i=r.timeLastEdited)||void 0===i?void 0:i.slice(0,10)]})]})]})]})});r.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(u,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.8c124395.chunk.js.map